From 42a2ab9ba4a548ee1cfe0fcb3011ae86650eed10 Mon Sep 17 00:00:00 2001
From: xubing <bing.xu@intel.com>
Date: Fri, 22 Sep 2023 08:45:32 +0800
Subject: [PATCH] Fix app auto exit on com.moji.mjweather.

Signed-off-by: xubing <bing.xu@intel.com>
---
 core/java/android/view/ViewGroup.java | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/core/java/android/view/ViewGroup.java b/core/java/android/view/ViewGroup.java
index 679da313edcc..736fd10bc9d9 100644
--- a/core/java/android/view/ViewGroup.java
+++ b/core/java/android/view/ViewGroup.java
@@ -133,7 +133,7 @@ import java.util.function.Predicate;
  */
 @UiThread
 public abstract class ViewGroup extends View implements ViewParent, ViewManager {
-    private static final String TAG = "ViewGroup";
+    private static final String TAG = "XB ViewGroup";
 
     @UnsupportedAppUsage(maxTargetSdk = Build.VERSION_CODES.R, trackingBug = 170729553)
     private static final boolean DBG = false;
@@ -2535,6 +2535,7 @@ public abstract class ViewGroup extends View implements ViewParent, ViewManager
         if (childrenCount != 0) {
             final float x = event.getX();
             final float y = event.getY();
+            Log.e("XB ViewGroup", "dispatchGenericPointerEvent x: " + x + ", y : "+ y);
 
             final ArrayList<View> preorderedList = buildOrderedChildList();
             final boolean customOrder = preorderedList == null
@@ -2543,8 +2544,9 @@ public abstract class ViewGroup extends View implements ViewParent, ViewManager
             for (int i = childrenCount - 1; i >= 0; i--) {
                 final int childIndex = getAndVerifyPreorderedIndex(childrenCount, i, customOrder);
                 final View child = getAndVerifyPreorderedView(preorderedList, children, childIndex);
-                if (!child.canReceivePointerEvents()
+                if (child == null || !child.canReceivePointerEvents()
                         || !isTransformedTouchPointInView(x, y, child, null)) {
+                    Log.e("XB ViewGroup", "dispatchGenericPointerEvent continue ...child: " + child);
                     continue;
                 }
 
@@ -3763,12 +3765,14 @@ public abstract class ViewGroup extends View implements ViewParent, ViewManager
         final View child;
         if (preorderedList != null) {
             child = preorderedList.get(childIndex);
+            Log.e("XB ViewGroup", "getAndVerifyPreorderedView preorderedList.size: " + preorderedList.size() + ", childIndex : "+ childIndex);
             if (child == null) {
                 throw new RuntimeException("Invalid preorderedList contained null child at index "
                         + childIndex);
             }
         } else {
             child = children[childIndex];
+            Log.e("XB ViewGroup", "getAndVerifyPreorderedView children.size: " + children.length + ", childIndex : "+ childIndex);
         }
         return child;
     }
-- 
2.34.1

